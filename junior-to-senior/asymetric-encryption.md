# asymmetric encryption

1. 影片
   1. <https://www.youtube.com/watch?v=NmM9HA2MQGI>
   2. <https://www.youtube.com/watch?v=Yjrfm_oRO0w>
   3. <https://www.youtube.com/watch?v=vsXMMT2CqqE&t=>
   4. <https://www.youtube.com/watch?v=NF1pwjL9-DE>
   5. 心得：
      1. Diffie–Hellman key exchange：
            1. 可以在不安全環境底下交換訊息。
            2. 用顏色比喻：Alice是藍色，公鑰是黃色，Bob是紅色，alice把(藍+黃)給Bob，Bob把(紅+黃)給Alice，關鍵在於駭客無法短時間內把這兩種混色重分離為原色，而Alice只要把Bob給的顏色再加上自己的藍色就可以得到(紅+黃+藍)，Bob也是把Alice給的顏色再加上自己的紅色，也可以得到相同的(紅+黃+藍)。
            3. 限制：只能讓監聽者無法短時間破譯，如果有伺服者欄截再傳送給雙方，那就沒用，因為DH解決的是信任的雙方傳secret，而欄截者都是雙方信任的另一方。
      2. RSA能解決DH的問題，即使上游伺服器欄截，但我我研究後，似乎不行，還是得靠憑證解決。
2. 網路文章解釋RSA怎麼做到：
   1. <https://segmentfault.com/a/1190000039055271>
   2. 過程可能如後，Alice要傳訊給Bob，Bob弄出一組公鑰和私鑰，把公鑰給Alice，Alice用公鑰加密訊息後，把訊息丟給Bob，Bob用私鑰解密得到訊息。RSA的功能在於，如果沒有私鑰的話，就算拿到公鑰的加密訊息和公鑰，也解不開獲得原來的訊息。
   3. 但是RSA無法解決中間人攻擊的問題，假設攻擊者可以攔截雙方的訊息，他攔截了Bob的公鑰，產生一組假的私鑰並丟了一組假的公鑰給Alice，Alice用假公鑰加密之後丟出訊息，攻者攔截後用假的私鑰解出訊息，再用真公鑰加密丟給Bob，那Bob依然可以解出訊息，雙方都不知道有中間人攔截。
   4. 中間人甚至不只監聽訊息，還能竄改訊息。
   5. 解決中間公攻擊的方式：Certificate Authority(CA)
      1. CA是大家(或瀏覽器)信任的第三方機構。
      2. CA會給大家公鑰，然後CA發佈的訊息用自己的私鑰加密，這樣大家就可以用公鑰驗證訊息是不是CA發佈的。
      3. 所以如果Alice要傳訊息給Bob的話：
            1. 要把訊息和公鑰給CA
            2. CA用自己的私鑰對訊息和公鑰加密讓Alice得到數字證書
            3. Alice用自己的私鑰對訊息一段摘要進行hash當作數字簽名。
            4. 把數字簽名和數字證書給Bob
            5. Bob用CA的公鑰解密，得到Alice的公鑰和訊息。
            6. Bob用Alice的公鑰驗證數字的正確性。
   6. 中間人為什麼無法攻擊成功了？
      1. 中間人可能成功的功擊方式：
            1. 中間人攔截Alice的數字簽名和數字證書，用CA的公錀解出Alice的公鑰和訊息，進行竄改之後要丟給中間人之前，必需先給CA用自己的私鑰加密成假的數字證書。 
            2. 中間人將數字簽名用Alice給的公鑰解開成訊息的摘要，然後用自己的私鑰將摘要進行hash得到假的數字簽名。
            3. 中間人將Alice的訊息加上假的數字簽名和假的數字證書，丟給Bob。
            4. Bob用真的CA公鑰解開假的數位證書，拿到中間人給的假的私鑰和訊息，用中間人假的數字簽名驗證後，以為訊息為真。
      2. 中間人難以成功的關鍵：
            1. RSA只能解決安全性，也就是雙方之間通訊的安全性的問題，無法解決雙方是否信任的問題，所以嚴格來說，純RSA可能還是無法解決所有問題。
            2. 解決信任問題得靠CA，若CA太過濫發數位證書，造成安全性問題，有可能被瀏覽器移除，成為不可信任。所以過程中，中間人假如要將Alice訊息加上假的公鑰給CA做成數字證書，時間不會那麼快，而且CA可能也會視是否信任而接不接受做成數字證書。如果中間人無法拿到受信任的數位證書，那麼就無法丟給Bob，讓Bob能用受信任的公鑰解開，Bob的瀏覽器會出現不受信任的警告。
            3. 如果不是透過CA的話，就必需有一小段「受信任」的時期能交付公鑰，交付沒受竄改過的公鑰之後，以後的時間連線就安全了。
      3. 心得：
            1. 難怪架站的時候netlify要取得憑證需要花時間，受信任的網站是事件就花時間取得受信任的憑證了，所以在連線瞬間就不需要花時間取得憑證。
            2. 難怪貴的憑證要錢，而且審核嚴格，因為「信任性」還是有差。
            3. 中間人應該難以在短時間內拿到雙方公鑰後迅速取得受信任的憑證。
            4. 和github之間SSH連線的時候，要先交公鑰給github：
               1. 因為沒有取得憑證，所以要在安全的情況下交公鑰給github。
               2. 如果交公鑰的時間是安全的，以後就比較安全，不需怕之後過程中被截取密碼的情況。所以如果github不是用ssh的方式連線的話，每次連線都會冒一次被駭的風險。
               3. 如果交公鑰的瞬間是危險的，那麼也沒屁用。但是比起每次輸入密碼都需負擔一次風險，還是安全的多。